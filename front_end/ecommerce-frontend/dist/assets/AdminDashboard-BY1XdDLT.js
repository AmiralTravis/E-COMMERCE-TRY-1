import{_ as x,u as F,h as _,e as r,f as S,g as u,c as o,a,t as f,p as A,y as b,i as p,j as c,F as U,q as V,o as i,d as q}from"./index-Clrnze2-.js";const C={class:"admin-dashboard"},M={key:0,class:"loading-message"},D={key:1,class:"error-message"},E={key:2,class:"dashboard-content"},N={key:0,class:"admin-management-section"},T={class:"management-forms"},B={class:"form-section"},I={class:"form-section"},L={class:"admin-list"},R=["onClick"],j={__name:"AdminDashboard",setup(O){const h=F(),v=_(()=>h.isSuperAdmin),y=r(!0),t=r(null),l=r({username:"",email:"",password:""}),d=r({email:""}),g=r([]);S(async()=>{try{await Promise.all([m()])}catch{t.value="Failed to load dashboard data. Please try again later."}finally{y.value=!1}});async function m(){try{const n=await u.get("/admin/all-admins");g.value=n.data}catch{t.value="Failed to fetch admin list. Please try again later."}}async function w(){try{await u.post("/admin/create-admin",l.value),l.value={username:"",email:"",password:""},await m()}catch{t.value="Failed to create admin account. Please try again."}}async function P(){try{await u.post("/admin/promote-to-admin",{email:d.value.email}),d.value.email="",await m()}catch{t.value="Failed to promote user to admin. Please verify the email address."}}async function k(n){if(!v.value){t.value="Only superadmins can remove admins.";return}try{const e=await u.post("/admin/remove-admin",{username:n.username,email:n.email});e.data.success?await m():t.value=e.data.message||"Failed to remove admin. Please try again."}catch(e){e.response&&e.response.status===400?t.value=e.response.data.message||"Invalid admin details. Please check the username and email.":t.value="Failed to remove admin. Please try again later."}}return(n,e)=>(i(),o("div",C,[e[11]||(e[11]=a("h1",{class:"text-centre text-2xl font-bold mb-6 text-gray-800"},"Admin Management",-1)),y.value?(i(),o("div",M,"Loading dashboard data...")):t.value?(i(),o("div",D,f(t.value),1)):(i(),o("div",E,[v.value?(i(),o("section",N,[e[9]||(e[9]=a("h2",null,"Admin Role Management",-1)),a("div",T,[a("div",B,[e[5]||(e[5]=a("h3",null,"Create New Admin",-1)),a("form",{onSubmit:b(w,["prevent"]),class:"admin-form"},[p(a("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.username=s),placeholder:"Username",required:"",class:"form-input"},null,512),[[c,l.value.username]]),p(a("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.email=s),type:"email",placeholder:"Email",required:"",class:"form-input"},null,512),[[c,l.value.email]]),p(a("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.password=s),type:"password",placeholder:"Password",required:"",class:"form-input"},null,512),[[c,l.value.password]]),e[4]||(e[4]=a("button",{type:"submit",class:"form-button"},"Create Admin",-1))],32)]),a("div",I,[e[7]||(e[7]=a("h3",null,"Promote Existing User to Admin",-1)),a("form",{onSubmit:b(P,["prevent"]),class:"admin-form"},[p(a("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.value.email=s),type:"email",placeholder:"User Email",required:"",class:"form-input"},null,512),[[c,d.value.email]]),e[6]||(e[6]=a("button",{type:"submit",class:"form-button"},"Promote to Admin",-1))],32)])]),e[10]||(e[10]=a("div",{class:"superadmin-section"},[a("h2",null,"Superadmin-exclusive Function")],-1)),a("div",L,[e[8]||(e[8]=a("h3",null,"All Admins",-1)),a("ul",null,[(i(!0),o(U,null,V(g.value,s=>(i(),o("li",{key:s.id,class:"admin-item"},[q(f(s.username)+" - "+f(s.email)+" ",1),v.value?(i(),o("button",{key:0,onClick:$=>k(s),class:"remove-button"},"Remove Admin",8,R)):A("",!0)]))),128))])])])):A("",!0)]))]))}},G=x(j,[["__scopeId","data-v-ab9a2704"]]);export{G as default};
