import{_ as V,u as U,e as k,f as $,g as h,l as n,h as B,c as d,a as t,b,w as g,d as _,r as D,i as m,v as F,j as S,k as H,m as q,p as x,F as z,q as E,s as O,o as i,n as A,t as y,x as T,y as Z}from"./index-Clrnze2-.js";const I={class:"products-dashboard"},K={class:"dashboard-header"},Q={class:"header-actions"},R={class:"filters-container"},W={class:"filters"},G={class:"filter-group"},J={class:"filter-group"},X={class:"filter-group"},Y={class:"table-container"},tt={class:"products-table"},et={class:"product-name"},st={class:"product-info"},ot={class:"product-name-text"},at={class:"product-price"},nt={class:"stock-status"},lt={class:"stock-indicator"},ct={class:"stock-text"},dt={key:0,class:"stock-alert"},it={class:"stock-update"},rt={class:"stock-control"},ut=["onUpdate:modelValue"],pt=["onClick","disabled"],kt={class:"product-actions"},mt={class:"action-buttons"},vt=["onClick"],ft={key:0,class:"no-results"},ht={__name:"ProductManagement",setup(_t){U(),O();const r=k([]),v=k(!1),u=k(""),c=k("name");$(async()=>{await j()});async function j(){try{const o=await h.get("/seller/products");r.value=o.data.map(e=>({...e,stockAdjustment:0}))}catch{n.error("Failed to fetch products")}}const w=B(()=>{let o=r.value;if(u.value){const s=u.value.toLowerCase();o=o.filter(a=>a.name.toLowerCase().includes(s))}v.value&&(o=o.filter(s=>s.stock<=10));const[e,l]=c.value.startsWith("-")?[c.value.slice(1),"desc"]:[c.value,"asc"];return o.sort((s,a)=>l==="asc"?s[e]>a[e]?1:-1:s[e]<a[e]?1:-1)});function N(o){return Math.min(o/100*100,100)}function C(o){return o<=10?"critical":o<=25?"warning":"healthy"}async function P(o){var e,l;try{const s=Number(o.stockAdjustment);if(isNaN(s)||s===0){n.error("Please enter a valid stock adjustment"),o.stockAdjustment=0;return}const a=o.stock,p=Math.max(s,-a);if(s!==p){n.warning(`Adjustment clamped to ${p} to prevent negative stock`),o.stockAdjustment=p;return}const f=o.stock+p;if(f<0){n.error("Stock cannot be negative");return}await h.patch(`/seller/products/${o.id}/stock`,{stock:f}),o.stock=f,o.stockAdjustment=0,n.success("Stock updated successfully")}catch(s){n.error(((l=(e=s.response)==null?void 0:e.data)==null?void 0:l.message)||"Failed to update stock")}}async function L(o){if(confirm("Are you sure you want to delete this product?"))try{await h.delete(`/seller/products/${o}`),r.value=r.value.filter(e=>e.id!==o),n.success("Product deleted successfully")}catch{n.error("Failed to delete product")}}function M(o){/[0-9]|-/.test(o.key)||o.preventDefault()}return(o,e)=>{const l=D("router-link");return i(),d("div",I,[t("div",K,[e[5]||(e[5]=t("h1",{class:"text-center text-2xl font-bold text-gray-800"},"Product Management",-1)),t("div",Q,[b(l,{to:"/seller/products/add",class:"add-product-button"},{default:g(()=>e[4]||(e[4]=[t("span",null,"+",-1),_(" Add New Product ")])),_:1})])]),t("div",R,[t("div",W,[t("div",G,[t("label",null,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s)},null,512),[[F,v.value]]),e[6]||(e[6]=_(" Show Low Stock Only (â‰¤ 10) "))])]),t("div",J,[e[7]||(e[7]=t("label",null,"Search:",-1)),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),placeholder:"Search by product name...",class:"search-input"},null,512),[[S,u.value]])]),t("div",X,[e[9]||(e[9]=t("label",null,"Sort By:",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>c.value=s),class:"sort-select"},e[8]||(e[8]=[q('<option value="name" data-v-ed4d477a>Name (A-Z)</option><option value="-name" data-v-ed4d477a>Name (Z-A)</option><option value="stock" data-v-ed4d477a>Stock (Low to High)</option><option value="-stock" data-v-ed4d477a>Stock (High to Low)</option><option value="price" data-v-ed4d477a>Price (Low to High)</option><option value="-price" data-v-ed4d477a>Price (High to Low)</option>',6)]),512),[[H,c.value]])])])]),t("div",Y,[t("table",tt,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",{class:"product-name"},"Product Name"),t("th",{class:"stock-status"},"Stock Status"),t("th",{class:"stock-update"},"Update Stock"),t("th",{class:"product-actions"},"Actions")])],-1)),t("tbody",null,[(i(!0),d(z,null,E(w.value,s=>(i(),d("tr",{key:s.id,class:A({"low-stock-row":s.stock<=10})},[t("td",et,[t("div",st,[t("div",ot,y(s.name),1),t("div",at,"$"+y(s.price.toFixed(2)),1)])]),t("td",nt,[t("div",lt,[t("div",{class:A(["stock-bar",C(s.stock)]),style:T({width:N(s.stock)+"%"})},null,6),t("div",ct,[t("span",null,y(s.stock)+" in stock",1),s.stock<=10?(i(),d("span",dt," (Low Stock!) ")):x("",!0)])])]),t("td",it,[t("div",rt,[m(t("input",{"onUpdate:modelValue":a=>s.stockAdjustment=a,type:"number",min:"-999",max:"999",class:"stock-input",onKeydown:e[3]||(e[3]=Z(a=>M(a),["prevent"]))},null,40,ut),[[S,s.stockAdjustment,void 0,{number:!0}]]),t("button",{onClick:a=>P(s),class:"update-button",disabled:!s.stockAdjustment}," Update ",8,pt)])]),t("td",kt,[t("div",mt,[b(l,{to:`/seller/products/edit/${s.id}`,class:"edit-button"},{default:g(()=>e[10]||(e[10]=[_(" Edit ")])),_:2},1032,["to"]),t("button",{onClick:a=>L(s.id),class:"delete-button"}," Delete ",8,vt)])])],2))),128))])]),w.value.length===0?(i(),d("div",ft," No products found matching your criteria. ")):x("",!0)])])}}},wt=V(ht,[["__scopeId","data-v-ed4d477a"]]);export{wt as default};
