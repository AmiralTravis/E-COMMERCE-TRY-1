import{_ as F,e as b,h as V,f as B,g as k,l as g,c as f,a as t,C as T,p as U,i,j as r,v as S,F as M,q as I,s as j,o as c,t as $}from"./index-Clrnze2-.js";import{P as K}from"./ProductImageManagement-9fEQxRNT.js";import"./FileUploadProgress-DuRP7KOC.js";const L={class:"product-add-container"},R={class:"productImage mb-6"},q={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},H={class:"lg:col-span-2 space-y-6"},Q={class:"panel"},z={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},G={class:"form-group"},J=["value"],X={class:"form-group"},Y={class:"form-group"},Z={class:"form-group"},ee={class:"form-group"},te={class:"form-group"},se={class:"panel"},ne={class:"space-y-4"},oe={class:"form-group"},le={class:"form-group"},ae={class:"grid grid-cols-2 gap-4"},ie={class:"form-group"},de={class:"form-group"},ue={class:"panel"},re={class:"space-y-4"},me={class:"flex items-center gap-2"},ce={class:"flex items-center gap-2"},pe={class:"panel"},ve={class:"space-y-4"},ge={class:"form-group"},fe={class:"grid grid-cols-3 gap-4"},ye={class:"form-group"},be={class:"form-group"},he={class:"form-group"},De={class:"space-y-6"},ke={class:"panel"},Pe={class:"category-checkboxes space-y-2"},xe={class:"flex items-center gap-2 p-2 bg-gray-50 rounded"},we=["id","checked","onChange"],Ce=["for"],Ve={key:0,class:"subcategories ml-6 mt-1 space-y-2"},Ue=["id","checked","onChange"],Se=["for"],Me={__name:"ProductAdd",setup(Ie){const P=j(),n=b({name:"",description:"",price:0,discountPercentage:0,costPrice:0,stock:0,images:[],dummyData:{sku:"",trackInventory:!0,continueWhenOutOfStock:!1,weight:0,dimensions:{length:0,width:0,height:0},discountDates:{start:"",end:""}}}),h=b([]),m=b([]),u=b([]),y=b(0),p=V({get:()=>n.value.price,set:o=>{const e=Number(o)||0;if(n.value.price=e,e>0&&y.value>0){const s=(e-y.value)/e*100;n.value.discountPercentage=Math.min(Math.max(s,0),75)}}}),x=V({get:()=>Math.round(n.value.discountPercentage),set:o=>{const e=Math.min(Math.max(Math.round(Number(o)||0),0),75);n.value.discountPercentage=e,y.value=p.value*(1-e/100)}}),E=o=>{const e=Number(o)||0;if(y.value=e,p.value>0){const s=Math.min(Math.max(Math.round((p.value-e)/p.value*100),0),75);n.value.discountPercentage=s}},_=()=>{n.value.dummyData.weight<0&&(g.error("Weight cannot be negative"),n.value.dummyData.weight=0)},D=o=>{const e=n.value.dummyData.dimensions||{};(e[o]||0)<0&&(g.error("Dimensions cannot be negative"),e[o]=0)},w=()=>{if(n.value.dummyData.discountDates.start&&n.value.dummyData.discountDates.end){const o=new Date(n.value.dummyData.discountDates.start),e=new Date(n.value.dummyData.discountDates.end);o>e&&(g.error("End date must be after start date"),n.value.dummyData.discountDates.end="")}},A=async()=>{var o,e;try{const s={name:n.value.name,description:n.value.description,price:n.value.price,discountPercentage:n.value.discountPercentage,costPrice:n.value.costPrice,stock:n.value.stock,categoryIds:[...m.value.map(d=>d.id),...u.value.map(d=>d.id)]},a=(await k.post("/seller/products",s)).data.id;if(n.value.images.length>0){const d=new FormData;n.value.images.forEach(v=>{v.file&&d.append("thumbnails",v.file)}),await k.post(`/admin/products/${a}/thumbnails`,d,{headers:{"Content-Type":"multipart/form-data"}})}g.success("Product added successfully"),P.push("/admin/manage-products")}catch(s){console.error("Add product error:",s),g.error(((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.error)||"Failed to add product")}},N=()=>{P.push("/admin/manage-products")},O=o=>m.value.some(e=>e.id===o.id),W=o=>u.value.some(e=>e.id===o.id),C=(o,e)=>{if(e)m.value.some(l=>l.id===o.id)?(m.value=m.value.filter(l=>l.id!==o.id),u.value=u.value.filter(l=>!o.children.some(a=>a.id===l.id))):(m.value=[...m.value,o],u.value=[...u.value,...o.children.filter(l=>!u.value.some(a=>a.id===l.id))]);else if(u.value.some(l=>l.id===o.id)){u.value=u.value.filter(a=>a.id!==o.id);const l=h.value.find(a=>{var d;return(d=a.children)==null?void 0:d.some(v=>v.id===o.id)});l&&!l.children.some(a=>u.value.some(d=>d.id===a.id))&&(m.value=m.value.filter(a=>a.id!==l.id))}else{u.value=[...u.value,o];const l=h.value.find(a=>{var d;return(d=a.children)==null?void 0:d.some(v=>v.id===o.id)});l&&!m.value.some(a=>a.id===l.id)&&(m.value=[...m.value,l])}};return B(async()=>{try{const o=await k.get("/products/categories");h.value=o.data}catch(o){console.error("Error loading categories:",o),g.error("Failed to load categories")}}),(o,e)=>(c(),f("div",L,[e[41]||(e[41]=t("h1",{class:"text-2xl font-bold my-6 pt-2"},"Add New Product",-1)),t("div",R,[Array.isArray(n.value.images)?(c(),T(K,{key:0,modelValue:n.value.images,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value.images=s)},null,8,["modelValue"])):U("",!0)]),t("div",q,[t("div",H,[t("section",Q,[e[26]||(e[26]=t("h2",{class:"section-title"},"Pricing & Discount",-1)),t("div",z,[t("div",G,[e[20]||(e[20]=t("label",null,"Selling Price",-1)),t("input",{value:y.value.toFixed(2),type:"number",step:"0.01",min:"0",class:"form-input",onInput:e[1]||(e[1]=s=>E(s.target.value)),placeholder:"0.00"},null,40,J)]),t("div",X,[e[21]||(e[21]=t("label",null,"Original Price",-1)),i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),type:"number",step:"0.01",min:"0",class:"form-input",placeholder:"0.00"},null,512),[[r,p.value,void 0,{number:!0}]])]),t("div",Y,[e[22]||(e[22]=t("label",null,"Cost Price",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>n.value.costPrice=s),type:"number",step:"0.01",min:"0",class:"form-input",placeholder:"0.00"},null,512),[[r,n.value.costPrice,void 0,{number:!0}]])]),t("div",Z,[e[23]||(e[23]=t("label",null,"Discount Percentage",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s),type:"number",step:"1",min:"0",max:"75",class:"form-input",placeholder:"0"},null,512),[[r,x.value,void 0,{number:!0}]])]),t("div",ee,[e[24]||(e[24]=t("label",null,"Start Date",-1)),i(t("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=s=>n.value.dummyData.discountDates.start=s),class:"form-input",onChange:w},null,544),[[r,n.value.dummyData.discountDates.start]])]),t("div",te,[e[25]||(e[25]=t("label",null,"End Date",-1)),i(t("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=s=>n.value.dummyData.discountDates.end=s),class:"form-input",onChange:w},null,544),[[r,n.value.dummyData.discountDates.end]])])])]),t("section",se,[e[31]||(e[31]=t("h2",{class:"section-title"},"Product Details",-1)),t("div",ne,[t("div",oe,[e[27]||(e[27]=t("label",null,"Product Name",-1)),i(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>n.value.name=s),class:"form-input",placeholder:"Enter product name"},null,512),[[r,n.value.name]])]),t("div",le,[e[28]||(e[28]=t("label",null,"Description",-1)),i(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>n.value.description=s),rows:"4",class:"form-input",placeholder:"Enter product description"},null,512),[[r,n.value.description]])]),t("div",ae,[t("div",ie,[e[29]||(e[29]=t("label",null,"SKU",-1)),i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>n.value.dummyData.sku=s),class:"form-input",placeholder:"Enter SKU"},null,512),[[r,n.value.dummyData.sku]])]),t("div",de,[e[30]||(e[30]=t("label",null,"Stock Quantity",-1)),i(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>n.value.stock=s),type:"number",class:"form-input",placeholder:"Enter stock"},null,512),[[r,n.value.stock,void 0,{number:!0}]])])])])]),t("section",ue,[e[34]||(e[34]=t("h2",{class:"section-title"},"Inventory Management",-1)),t("div",re,[t("div",me,[i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>n.value.dummyData.trackInventory=s),type:"checkbox",id:"trackInventory",class:"w-4 h-4"},null,512),[[S,n.value.dummyData.trackInventory]]),e[32]||(e[32]=t("label",{for:"trackInventory"},"Track inventory for this product",-1))]),t("div",ce,[i(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>n.value.dummyData.continueWhenOutOfStock=s),type:"checkbox",id:"continueSelling",class:"w-4 h-4"},null,512),[[S,n.value.dummyData.continueWhenOutOfStock]]),e[33]||(e[33]=t("label",{for:"continueSelling"},"Continue selling when out of stock",-1))])])]),t("section",pe,[e[39]||(e[39]=t("h2",{class:"section-title"},"Shipping Details",-1)),t("div",ve,[t("div",ge,[e[35]||(e[35]=t("label",null,"Weight (kg)",-1)),i(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>n.value.dummyData.weight=s),type:"number",step:"0.1",min:"0",max:"1000",class:"form-input",placeholder:"0.0",onChange:_},null,544),[[r,n.value.dummyData.weight,void 0,{number:!0}]])]),t("div",fe,[t("div",ye,[e[36]||(e[36]=t("label",null,"Length",-1)),i(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>n.value.dummyData.dimensions.length=s),type:"number",min:"0",max:"500",class:"form-input",placeholder:"cm",onChange:e[15]||(e[15]=s=>D("length"))},null,544),[[r,n.value.dummyData.dimensions.length,void 0,{number:!0}]])]),t("div",be,[e[37]||(e[37]=t("label",null,"Width",-1)),i(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>n.value.dummyData.dimensions.width=s),type:"number",min:"0",max:"500",class:"form-input",placeholder:"cm",onChange:e[17]||(e[17]=s=>D("width"))},null,544),[[r,n.value.dummyData.dimensions.width,void 0,{number:!0}]])]),t("div",he,[e[38]||(e[38]=t("label",null,"Height",-1)),i(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>n.value.dummyData.dimensions.height=s),type:"number",min:"0",max:"500",class:"form-input",placeholder:"cm",onChange:e[19]||(e[19]=s=>D("height"))},null,544),[[r,n.value.dummyData.dimensions.height,void 0,{number:!0}]])])])])])]),t("div",De,[t("section",ke,[e[40]||(e[40]=t("h2",{class:"section-title"},"Categories",-1)),t("div",Pe,[(c(!0),f(M,null,I(h.value,s=>(c(),f("div",{key:s.id,class:"category-group"},[t("div",xe,[t("input",{type:"checkbox",id:`category-${s.id}`,checked:O(s),onChange:l=>C(s,!0),class:"w-4 h-4"},null,40,we),t("label",{for:`category-${s.id}`,class:"font-medium"},$(s.name),9,Ce)]),s.children&&s.children.length?(c(),f("div",Ve,[(c(!0),f(M,null,I(s.children,l=>(c(),f("div",{key:l.id,class:"flex items-center gap-2"},[t("input",{type:"checkbox",id:`subcategory-${l.id}`,checked:W(l),onChange:a=>C(l,!1),class:"w-4 h-4"},null,40,Ue),t("label",{for:`subcategory-${l.id}`},$(l.name),9,Se)]))),128))])):U("",!0)]))),128))])])])]),t("div",{class:"sticky bottom-0 bg-white py-4 border-t mt-8 flex justify-end gap-4"},[t("button",{onClick:N,class:"btn-secondary"},"Cancel"),t("button",{onClick:A,class:"btn-primary"},"Add Product")])]))}},Ae=F(Me,[["__scopeId","data-v-d6a3c827"]]);export{Ae as default};
